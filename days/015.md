# Setup SSL for NGINX

The system admins team of xFusionCorp Industries needs to deploy a new application on App Server 3 in Stratos Datacenter. They have some pre-requites to get ready that server for application deployment. Prepare the server as per requirements shared below:

1. Install and configure `nginx` on `App Server 3`.

2. On App Server 3 there is a self signed SSL certificate and key present at location `/tmp/nautilus.crt` and `/tmp/nautilus.key`. Move them to some appropriate location and deploy the same in Nginx.

3. Create an `index.html` file with content `Welcome!` under Nginx document root.

4. For final testing try to access the App Server 3 link (either hostname or IP) from jump host using curl command. For example `curl -Ik https://<app-server-ip>/`.

## Steps

1. Install nginx

    ```sh
    sudo yum install nginx -y
    ```

2. Change default `index.html` content:

    ```sh
    echo "Welcome!" | sudo tee /usr/share/nginx/html/index.html
    ```

3. Restart and check if nginx is accesible from jump host:

    ```sh
    sudo systemctl restart nginx
    curl http://stapp03
    ```

4. Copy ssl from `/tmp`:

    ```sh
    sudo mkdir -p /etc/certs
    sudo cp /tmp/nautilus.* /etc/certs
    ```

5. Configure SSL:

    ```sh
    sudo vi /etc/nginx/nginx.conf
    ```

    We have to be cautious here, otherwise nginx could be broken.

    We need to add this line inside `server:80` just after `server_name`.

    ```shell
    return 301 https://$host$request_uri;
    ```

    Then we have to uncomment `server:443` and add following lines:

    ```nginx
    ssl_certificate     /etc/certs/nautilus.crt;
    ssl_certificate_key /etc/certs/nautilus.key;
    ```

    If you need to update anything else do respectively. Before restart the `ngninx` server make sure you are testin it using:

    ```sh
    sudo nginx -t
    ```

    If it returns successful, you are ready to restart nginx:

    ```sh
    sudo systemctl restart nginx
    ```

6. Finally test

    ```curl -k https://stapp03
    ```

## Good to Know?

### SSL/TLS Fundamentals

- **Purpose**: Encrypt data in transit, authenticate server identity
- **Certificates**: Digital certificates contain public key and identity info
- **Private Key**: Must be kept secure, used for decryption
- **Self-signed**: Not trusted by browsers, good for testing

### NGINX SSL Configuration

- **ssl_certificate**: Path to certificate file (.crt, .pem)
- **ssl_certificate_key**: Path to private key file (.key)
- **ssl_protocols**: Specify allowed TLS versions
- **ssl_ciphers**: Define encryption algorithms

### Security Best Practices

- **Strong Ciphers**: Use modern, secure cipher suites
- **HSTS**: HTTP Strict Transport Security header
- **Redirect HTTP**: Force HTTPS with 301 redirects
- **Key Security**: Protect private keys (600 permissions)

### Certificate Management

- **Let's Encrypt**: Free automated certificates
- **Certificate Authority**: Trusted third-party issuers
- **Expiration**: Monitor and renew certificates
- **Chain**: Include intermediate certificates
